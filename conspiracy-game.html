<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Conspiracy Theory Game ‚Äî Braeden Pope</title>
  <meta name="description" content="Play the Waterdeep Conspiracy Theory Game - A fun D&D campaign game." />
  <link rel="stylesheet" href="styles.css" />
  <style>
    .game-container {
      max-width: 1200px;
      width: 100%;
      padding: 20px;
      text-align: center;
      margin: 0 auto;
    }

    .game-title {
      font-size: 2.5em;
      margin-bottom: 30px;
      color: var(--brand);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .screen {
      display: none;
      animation: fadeIn 0.5s ease-in;
    }

    .screen.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .lobby-code {
      font-size: 3em;
      background: rgba(122, 162, 255, 0.2);
      padding: 20px;
      border-radius: 15px;
      margin: 20px 0;
      border: 2px solid var(--brand);
      font-family: monospace;
      letter-spacing: 0.2em;
    }

    .players-list {
      background: var(--card);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      min-height: 150px;
      border: 1px solid #1b1f2a;
    }

    .player-item {
      background: rgba(122, 162, 255, 0.2);
      margin: 10px;
      padding: 15px;
      border-radius: 8px;
      display: inline-block;
      min-width: 150px;
      border: 1px solid rgba(122, 162, 255, 0.3);
    }

    .prompt-display {
      background: var(--card);
      border-radius: 15px;
      padding: 30px;
      margin: 20px 0;
      font-size: 1.3em;
      line-height: 1.5;
      border: 2px solid rgba(122, 162, 255, 0.3);
    }

    .timer {
      font-size: 2em;
      color: #ff6b6b;
      margin: 20px 0;
      font-weight: bold;
      text-shadow: 0 0 10px rgba(255,107,107,0.5);
    }

    .timer.warning {
      animation: pulse 1s infinite;
      color: #ff4757;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .answers-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .answer-item {
      background: var(--card);
      border-radius: 10px;
      padding: 20px;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .answer-item:hover {
      border-color: var(--brand);
      transform: translateY(-2px);
      background: rgba(122, 162, 255, 0.1);
    }

    .answer-item.voted {
      border-color: var(--accent);
      background: rgba(24, 194, 156, 0.2);
    }

    .answer-item.non-clickable {
      cursor: default;
    }

    .vote-count {
      font-size: 1.5em;
      color: var(--brand);
      font-weight: bold;
      margin-top: 10px;
    }

    .game-btn {
      background: linear-gradient(45deg, var(--brand), #5a8aff);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 25px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .game-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(122, 162, 255, 0.3);
    }

    .game-btn:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      opacity: 0.6;
    }

    .game-btn.success {
      background: linear-gradient(45deg, var(--accent), #44a08d);
      color: white;
    }

    .input-field {
      padding: 15px;
      border-radius: 10px;
      border: 2px solid var(--brand);
      background: rgba(255,255,255,0.1);
      color: var(--text);
      font-size: 1.1em;
      margin: 10px;
      width: 300px;
      transition: border-color 0.3s ease;
    }

    .input-field:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(255,255,255,0.15);
    }

    .input-field::placeholder {
      color: rgba(232, 236, 241, 0.7);
    }

    .scoreboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }

    .score-item {
      background: rgba(122, 162, 255, 0.2);
      border-radius: 10px;
      padding: 20px;
      border: 2px solid var(--brand);
      position: relative;
    }

    .score-item.winner {
      border-color: var(--accent);
      background: rgba(24, 194, 156, 0.3);
    }

    .score-item.winner::before {
      content: "üëë";
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 2em;
    }

    .score-name {
      font-size: 1.3em;
      margin-bottom: 10px;
      font-weight: bold;
    }

    .score-points {
      font-size: 2em;
      color: var(--accent);
      font-weight: bold;
    }

    .mobile-input {
      width: 100%;
      max-width: 500px;
      margin: 20px auto;
    }

    .mobile-input textarea {
      width: 100%;
      padding: 15px;
      border-radius: 10px;
      border: 2px solid var(--brand);
      background: rgba(255,255,255,0.1);
      color: var(--text);
      font-size: 1.1em;
      resize: vertical;
      min-height: 100px;
      font-family: inherit;
    }

    .mobile-input textarea:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(255,255,255,0.15);
    }

    .mobile-input textarea::placeholder {
      color: rgba(232, 236, 241, 0.7);
    }

    .status-message {
      background: rgba(24, 194, 156, 0.2);
      border: 1px solid var(--accent);
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      color: var(--accent);
    }

    .error-message {
      background: rgba(255, 107, 107, 0.2);
      border: 1px solid #ff6b6b;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      color: #ff6b6b;
    }

    .round-info {
      background: rgba(255,255,255,0.05);
      border-radius: 10px;
      padding: 15px;
      margin: 15px 0;
      font-size: 1.2em;
    }

    .waiting-indicator {
      display: inline-block;
      animation: spin 1s infinite linear;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .game-title {
        font-size: 1.8em;
      }
      
      .lobby-code {
        font-size: 2em;
      }
      
      .input-field {
        width: 250px;
      }
      
      .answers-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .game-title {
        font-size: 1.5em;
      }
      
      .lobby-code {
        font-size: 1.5em;
        padding: 15px;
      }
      
      .input-field {
        width: 90%;
      }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <nav><div class="container nav-inner"><div class="brand"><a href="index.html">Braeden Pope</a></div><ul class="nav-links"><li><a data-page="index.html" href="index.html">Home</a></li><li><a data-page="projects.html" href="projects.html">Projects</a></li><li><a data-page="about.html" href="about.html">About</a></li>        <li><a data-page="contact.html" href="contact.html">Contact</a></li><li><a data-page="conspiracy-game.html" href="conspiracy-game.html">Game</a></li></ul></div></nav>

  <div class="container">
    <div class="game-container">
      <h1 class="game-title">üïµÔ∏è Waterdeep Conspiracy Theories üïµÔ∏è</h1>
      
      <!-- Main Menu -->
      <div id="main-menu" class="screen active">
        <div style="margin-bottom: 30px;">
          <p style="font-size: 1.2em; margin-bottom: 20px;">
            Create wild conspiracy theories about your D&D campaign!
          </p>
        </div>
        <button class="game-btn" onclick="showHostView()">üéÆ Host Game</button>
        <button class="game-btn" onclick="showPlayerView()">üì± Join Game</button>
      </div>

      <!-- Host View -->
      <div id="host-view" class="screen">
        <!-- Lobby Setup -->
        <div id="host-lobby" class="host-screen active">
          <h2>üéÆ Game Lobby</h2>
          <p>Players can join using this code:</p>
          <div class="lobby-code" id="lobby-code">ABCD</div>
          <p style="margin: 10px 0;">Share this URL with players:<br>
          <strong id="game-url">Loading...</strong></p>
          
          <div class="players-list">
            <h3>Players in Lobby (<span id="lobby-player-count">0</span>):</h3>
            <div id="players-container">
              <p style="color: #888;">Waiting for players to join...</p>
            </div>
          </div>
          
          <button class="game-btn" onclick="startGame()" id="start-game-btn">Start Game</button>
          <button class="game-btn" onclick="showMainMenu()">Back to Menu</button>
        </div>

        <!-- Game Round -->
        <div id="host-game" class="host-screen">
          <div class="round-info">
            <h2>Round <span id="round-number">1</span> of 4</h2>
          </div>
          
          <div class="prompt-display" id="prompt-display">
            Loading prompt...
          </div>
          
          <div class="timer" id="timer">60</div>
          
          <div id="waiting-message">
            <p><span class="waiting-indicator">‚è≥</span> Players are writing their conspiracy theories...</p>
            <p><strong>Submitted:</strong> <span id="submitted-count">0</span>/<span id="total-players">0</span></p>
          </div>
          
          <button class="game-btn" id="skip-timer" onclick="skipTimer()">Skip Timer ‚è≠Ô∏è</button>
        </div>

        <!-- Voting Phase -->
        <div id="host-voting" class="host-screen">
          <h2>üó≥Ô∏è Vote for the Best Conspiracy Theory!</h2>
          <div class="answers-grid" id="host-answers-grid"></div>
          <div class="status-message">
            <p><span class="waiting-indicator">‚è≥</span> Waiting for all players to vote...</p>
            <p><strong>Voted:</strong> <span id="voted-count">0</span>/<span id="total-players-voting">0</span></p>
          </div>
        </div>

        <!-- Results -->
        <div id="host-results" class="host-screen">
          <h2>üìä Round Results</h2>
          <div class="answers-grid" id="results-grid"></div>
          <button class="game-btn" id="next-round-btn" onclick="nextRound()">Next Round ‚û°Ô∏è</button>
        </div>

        <!-- Final Scores -->
        <div id="host-final" class="host-screen">
          <h2>üèÜ Final Results üèÜ</h2>
          <div class="scoreboard" id="final-scoreboard"></div>
          <button class="game-btn" onclick="resetGame()">üéÆ New Game</button>
          <button class="game-btn" onclick="showMainMenu()">Main Menu</button>
        </div>
      </div>

      <!-- Player View -->
      <div id="player-view" class="screen">
        <!-- Join Lobby -->
        <div id="player-join" class="player-screen active">
          <h2>üì± Join Game</h2>
          <input type="text" id="room-code" class="input-field" placeholder="Enter Room Code" maxlength="4" style="text-transform: uppercase;">
          <br>
          <input type="text" id="player-name" class="input-field" placeholder="Enter Your Name" maxlength="20">
          <br>
          <button class="game-btn" onclick="joinGame()">Join Game</button>
          <button class="game-btn" onclick="showMainMenu()">Back to Menu</button>
          <div id="join-error" class="error-message" style="display: none;"></div>
        </div>

        <!-- Waiting in Lobby -->
        <div id="player-waiting" class="player-screen">
          <h2>‚è≥ Waiting for Game to Start</h2>
          <div class="status-message">
            <p><strong>Room Code:</strong> <span id="player-room-code"></span></p>
            <p><strong>Your Name:</strong> <span id="player-display-name"></span></p>
          </div>
          <div class="players-list">
            <h3>Players in Lobby (<span id="player-lobby-count">0</span>):</h3>
            <div id="player-lobby-list"></div>
          </div>
        </div>

        <!-- Writing Phase -->
        <div id="player-writing" class="player-screen">
          <div class="round-info">
            <h2>Round <span id="player-round">1</span> of 4</h2>
          </div>
          
          <div class="prompt-display" id="player-prompt"></div>
          
          <div class="timer" id="player-timer">60</div>
          
          <div class="mobile-input">
            <textarea id="conspiracy-input" placeholder="Write your conspiracy theory here... Be creative and funny!"></textarea>
            <br>
            <button class="game-btn" onclick="submitConspiracy()" id="submit-btn">Submit Theory</button>
          </div>
        </div>

        <!-- Voting Phase -->
        <div id="player-voting" class="player-screen">
          <h2>üó≥Ô∏è Vote for the Best Theory!</h2>
          <p><em>(You can't vote for your own theory)</em></p>
          <div class="answers-grid" id="player-answers-grid"></div>
          <div id="voting-status" class="status-message" style="display: none;"></div>
        </div>

        <!-- Round Results -->
        <div id="player-results" class="player-screen">
          <h2>üìä Round Results</h2>
          <div class="answers-grid" id="player-results-grid"></div>
          <div class="status-message">
            <p><span class="waiting-indicator">‚è≥</span> Waiting for next round...</p>
          </div>
        </div>

        <!-- Final Results -->
        <div id="player-final" class="player-screen">
          <h2>üèÜ Final Results üèÜ</h2>
          <div class="scoreboard" id="player-final-scoreboard"></div>
          <div class="status-message">
            <p>Thanks for playing! üéâ</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer><div class="container small">¬© <span id="y"></span> Braeden Pope</div></footer>
  <script src="script.js"></script>
  <script>document.getElementById('y').textContent=new Date().getFullYear()</script>
  
  <!-- Socket.io will be loaded from CDN since we can't use the /socket.io/ path in a static site -->
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    let socket;
    let gameState = {
      isHost: false,
      lobbyCode: '',
      playerName: '',
      playerId: '',
      currentRound: 1,
      maxRounds: 4,
      currentPrompt: '',
      hasSubmitted: false,
      hasVoted: false,
      connected: false
    };

    // Initialize socket connection
    function initSocket() {
      // Replace this URL with your deployed server URL
      const serverUrl = 'https://your-game-server.herokuapp.com'; // Change this!
      socket = io(serverUrl);
      
      socket.on('connect', () => {
        console.log('Connected to server');
        gameState.connected = true;
        gameState.playerId = socket.id;
        hideError();
      });

      socket.on('disconnect', () => {
        console.log('Disconnected from server');
        gameState.connected = false;
      });

      // Game events
      socket.on('gameCreated', ({ code }) => {
        gameState.lobbyCode = code;
        document.getElementById('lobby-code').textContent = code;
        document.getElementById('game-url').textContent = window.location.origin + '/conspiracy-game.html';
        updateStartButton();
      });

      socket.on('joinedGame', ({ code }) => {
        gameState.lobbyCode = code;
        document.getElementById('player-room-code').textContent = code;
        showPlayerScreen('player-waiting');
        hideError();
      });

      socket.on('playersUpdate', ({ players }) => {
        updatePlayersDisplay(players);
        updateStartButton(players.length);
      });

      socket.on('roundStart', ({ round, prompt, timeLeft }) => {
        gameState.currentRound = round;
        gameState.currentPrompt = prompt;
        gameState.hasSubmitted = false;
        gameState.hasVoted = false;
        
        document.getElementById('round-number').textContent = round;
        document.getElementById('player-round').textContent = round;
        document.getElementById('prompt-display').textContent = prompt;
        document.getElementById('player-prompt').textContent = prompt;
        
        if (gameState.isHost) {
          showHostScreen('host-game');
        } else {
          showPlayerScreen('player-writing');
          resetWritingInterface();
        }
        
        updateTimer(timeLeft);
      });

      socket.on('timerUpdate', ({ timeLeft }) => {
        updateTimer(timeLeft);
      });

      socket.on('submissionUpdate', ({ submitted, total }) => {
        document.getElementById('submitted-count').textContent = submitted;
        document.getElementById('total-players').textContent = total;
      });

      socket.on('votingPhase', ({ submissions }) => {
        if (gameState.isHost) {
          showHostScreen('host-voting');
        } else {
          showPlayerScreen('player-voting');
        }
        displayAnswersForVoting(submissions);
      });

      socket.on('voteUpdate', ({ voted, total }) => {
        document.getElementById('voted-count').textContent = voted;
        document.getElementById('total-players-voting').textContent = total;
      });

      socket.on('results', ({ results, isLastRound }) => {
        if (gameState.isHost) {
          showHostScreen('host-results');
          const nextBtn = document.getElementById('next-round-btn');
          if (isLastRound) {
            nextBtn.textContent = 'Show Final Results üèÜ';
            nextBtn.onclick = () => socket.emit('nextRound', { code: gameState.lobbyCode });
          } else {
            nextBtn.textContent = 'Next Round ‚û°Ô∏è';
            nextBtn.onclick = nextRound;
          }
        } else {
          showPlayerScreen('player-results');
        }
        displayResults(results);
      });

      socket.on('finalResults', ({ scores }) => {
        if (gameState.isHost) {
          showHostScreen('host-final');
        } else {
          showPlayerScreen('player-final');
        }
        displayFinalResults(scores);
      });

      socket.on('theorySubmitted', () => {
        const submitBtn = document.getElementById('submit-btn');
        submitBtn.textContent = '‚úÖ Theory Submitted!';
        submitBtn.classList.add('success');
        submitBtn.disabled = true;
        document.getElementById('conspiracy-input').disabled = true;
        gameState.hasSubmitted = true;
      });

      socket.on('voteRegistered', () => {
        const statusDiv = document.getElementById('voting-status');
        statusDiv.style.display = 'block';
        statusDiv.innerHTML = '‚úÖ Your vote has been registered!';
        gameState.hasVoted = true;
      });

      socket.on('error', (message) => {
        showError(message);
        console.error('Game error:', message);
      });
    }

    // Utility functions
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function showHostScreen(screenId) {
      document.querySelectorAll('.host-screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function showPlayerScreen(screenId) {
      document.querySelectorAll('.player-screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
    }

    function showMainMenu() {
      showScreen('main-menu');
      if (socket) {
        socket.disconnect();
      }
      resetGameState();
    }

    function resetGameState() {
      gameState = {
        isHost: false,
        lobbyCode: '',
        playerName: '',
        playerId: '',
        currentRound: 1,
        maxRounds: 4,
        currentPrompt: '',
        hasSubmitted: false,
        hasVoted: false,
        connected: false
      };
    }

    function showError(message) {
      const errorDiv = document.getElementById('join-error');
      if (errorDiv) {
        errorDiv.textContent = message;
        errorDiv.style.display = 'block';
      }
    }

    function hideError() {
      const errorDiv = document.getElementById('join-error');
      if (errorDiv) {
        errorDiv.style.display = 'none';
      }
    }

    // Host functions
    function showHostView() {
      gameState.isHost = true;
      showScreen('host-view');
      showHostScreen('host-lobby');
      initSocket();
    }

    function startGame() {
      if (gameState.connected && gameState.lobbyCode) {
        socket.emit('startGame', { code: gameState.lobbyCode });
      } else {
        showError('Not connected to server or no game created');
      }
    }

    function nextRound() {
      if (gameState.connected && gameState.lobbyCode) {
        socket.emit('nextRound', { code: gameState.lobbyCode });
      }
    }

    function skipTimer() {
      if (gameState.connected && gameState.lobbyCode) {
        socket.emit('skipTimer', { code: gameState.lobbyCode });
      }
    }

    function resetGame() {
      showHostView();
    }

    // Player functions
    function showPlayerView() {
      gameState.isHost = false;
      showScreen('player-view');
      showPlayerScreen('player-join');
    }

    function joinGame() {
      const code = document.getElementById('room-code').value.toUpperCase().trim();
      const name = document.getElementById('player-name').value.trim();
      
      if (!code || !name) {
        showError('Please enter both room code and your name!');
        return;
      }
      
      if (name.length > 20) {
        showError('Name must be 20 characters or less!');
        return;
      }
      
      gameState.playerName = name;
      document.getElementById('player-display-name').textContent = name;
      
      initSocket();
      
      // Wait for socket connection before joining
      const waitForConnection = () => {
        if (gameState.connected) {
          socket.emit('joinGame', { code, name });
        } else {
          setTimeout(waitForConnection, 100);
        }
      };
      waitForConnection();
    }

    function resetWritingInterface() {
      const input = document.getElementById('conspiracy-input');
      const btn = document.getElementById('submit-btn');
      
      input.value = '';
      input.disabled = false;
      btn.disabled = false;
      btn.textContent = 'Submit Theory';
      btn.classList.remove('success');
    }

    function submitConspiracy() {
      const theory = document.getElementById('conspiracy-input').value.trim();
      if (!theory) {
        alert('Please write a conspiracy theory!');
        return;
      }
      
      if (gameState.connected && gameState.lobbyCode) {
        socket.emit('submitTheory', { code: gameState.lobbyCode, theory });
      }
    }

    function voteForAnswer(playerId) {
      if (gameState.hasVoted || playerId === gameState.playerId) {
        return;
      }
      
      if (gameState.connected && gameState.lobbyCode) {
        socket.emit('vote', { code: gameState.lobbyCode, votedForId: playerId });
        
        // Update UI immediately
        document.querySelectorAll('.answer-item[data-id]').forEach(el => {
          el.classList.remove('voted');
          el.classList.add('non-clickable');
          el.onclick = null;
        });
        
        const votedElement = document.querySelector(`[data-id="${playerId}"]`);
        if (votedElement) {
          votedElement.classList.add('voted');
        }
      }
    }

    // Display functions
    function updatePlayersDisplay(players = []) {
      const hostContainer = document.getElementById('players-container');
      const playerContainer = document.getElementById('player-lobby-list');
      const hostCountElement = document.getElementById('lobby-player-count');
      const playerCountElement = document.getElementById('player-lobby-count');
      
      if (players.length === 0) {
        const waitingHTML = '<p style="color: #888;">Waiting for players to join...</p>';
        if (hostContainer) hostContainer.innerHTML = waitingHTML;
        if (playerContainer) playerContainer.innerHTML = waitingHTML;
      } else {
        const playerElements = players.map(player => 
          `<div class="player-item">${player.name}</div>`
        ).join('');
        
        if (hostContainer) hostContainer.innerHTML = playerElements;
        if (playerContainer) playerContainer.innerHTML = playerElements;
      }
      
      if (hostCountElement) hostCountElement.textContent = players.length;
      if (playerCountElement) playerCountElement.textContent = players.length;
    }

    function updateTimer(timeLeft) {
      const timerElements = [
        document.getElementById('timer'),
        document.getElementById('player-timer')
      ];
      
      timerElements.forEach(element => {
        if (element) {
          element.textContent = timeLeft;
          if (timeLeft <= 10) {
            element.classList.add('warning');
          } else {
            element.classList.remove('warning');
          }
        }
      });
    }

    function displayAnswersForVoting(submissions) {
      const hostGrid = document.getElementById('host-answers-grid');
      const playerGrid = document.getElementById('player-answers-grid');
      
      const hostHTML = submissions.map(sub => 
        `<div class="answer-item non-clickable">
          <div style="font-size: 1.1em; margin-bottom: 10px;">${sub.text}</div>
          <div style="font-style: italic; color: var(--brand);">by ${sub.playerName}</div>
        </div>`
      ).join('');
      
      const playerHTML = submissions.map(sub => {
        const isOwnTheory = sub.id === gameState.playerId;
        const clickHandler = isOwnTheory ? '' : `onclick="voteForAnswer('${sub.id}')"`;
        const className = isOwnTheory ? 'answer-item non-clickable' : 'answer-item';
        const ownTheoryLabel = isOwnTheory ? '<div style="color: var(--accent); font-weight: bold; margin-bottom: 5px;">Your Theory</div>' : '';
        
        return `<div class="${className}" ${clickHandler} data-id="${sub.id}">
          ${ownTheoryLabel}
          <div style="font-size: 1.1em;">${sub.text}</div>
        </div>`;
      }).join('');
      
      if (hostGrid) hostGrid.innerHTML = hostHTML;
      if (playerGrid) playerGrid.innerHTML = playerHTML;
    }

    function displayResults(results) {
      const resultsHTML = results.map(result => 
        `<div class="answer-item non-clickable">
          <div style="font-size: 1.1em; margin-bottom: 10px;">${result.text}</div>
          <div style="font-style: italic; color: var(--brand); margin-bottom: 10px;">by ${result.playerName}</div>
          <div class="vote-count">${result.votes} vote${result.votes !== 1 ? 's' : ''} ${result.votes > 0 ? 'üéâ' : ''}</div>
        </div>`
      ).join('');
      
      const hostResultsGrid = document.getElementById('results-grid');
      const playerResultsGrid = document.getElementById('player-results-grid');
      
      if (hostResultsGrid) hostResultsGrid.innerHTML = resultsHTML;
      if (playerResultsGrid) playerResultsGrid.innerHTML = resultsHTML;
    }

    function displayFinalResults(scores) {
      const scoreboardHTML = scores.map((player, index) => {
        const isWinner = index === 0;
        const className = isWinner ? 'score-item winner' : 'score-item';
        
        return `<div class="${className}">
          <div class="score-name">
            ${isWinner ? 'üèÜ ' : ''}${player.name}
            ${isWinner ? ' - WINNER!' : ''}
          </div>
          <div class="score-points">${player.score} point${player.score !== 1 ? 's' : ''}</div>
        </div>`;
      }).join('');
      
      const hostScoreboard = document.getElementById('final-scoreboard');
      const playerScoreboard = document.getElementById('player-final-scoreboard');
      
      if (hostScoreboard) hostScoreboard.innerHTML = scoreboardHTML;
      if (playerScoreboard) playerScoreboard.innerHTML = scoreboardHTML;
    }

    // Auto-uppercase room code input
    document.addEventListener('DOMContentLoaded', () => {
      const roomCodeInput = document.getElementById('room-code');
      if (roomCodeInput) {
        roomCodeInput.addEventListener('input', (e) => {
          e.target.value = e.target.value.toUpperCase();
        });
      }
    });
  </script>
</body>
</html>